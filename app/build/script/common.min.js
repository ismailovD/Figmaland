class NavStick {
  constructor(select) {
    this.nav = document.querySelector(select.el);
    this.rect = this.nav.getBoundingClientRect();
    this.top = this.rect.top;
    window.addEventListener('scroll', () => {
      if (pageYOffset > 0) {
        this.nav.classList.add('fixed');
      } else {
        this.nav.classList.remove('fixed');
      }
    });
  }

}

const navl = new NavStick({
  el: '.header__nav'
});

class SideBar {
  constructor(option) {
    this.nav = document.querySelector(option.el);
    this.menu = document.querySelector(option.menu);
    this.body = document.querySelector('body');
    this.nav.addEventListener('click', () => {
      this.menu.classList.add('active');
      document.addEventListener('mouseup', e => {
        if (e.target != this.menu) {
          this.menu.classList.remove('active');
        }
      });
    }, true);
    window.addEventListener('resize', () => {
      this.menu.classList.remove('active');
    });
  }

}

const navbar = new SideBar({
  el: '.burger__menu',
  menu: '.header__nav-side'
});
const panel = document.querySelector('.player__panel'),
      video = document.querySelector('.features__video'),
      playBtn = document.querySelector('.features__player-btn'),
      playTime = document.querySelector('.player__time-now'),
      fullTime = document.querySelector('.player__time-full'),
      progress = document.querySelector('.player__progress'),
      progressLine = document.querySelector('.player__progress-line'),
      progressHover = document.querySelector('.player__progress-hover'),
      playB = document.querySelector('.player__playOrPause-play'),
      pauseB = document.querySelector('.player__playOrPause-pause'),
      stopB = document.querySelector('.player__stop'),
      speedDown = document.querySelector('.player__speed-down'),
      speedUp = document.querySelector('.player__speed-up'),
      volumeOn = document.querySelector('.player__volume-on'),
      volumeOff = document.querySelector('.player__volume-off'),
      volumeLevel = document.querySelector('.player__volume-level'),
      download = document.querySelector('.player__download');
let speed = 1,
    playT,
    clickDisplay = 0,
    videoSrc = video.getAttribute('src');
download.setAttribute('href', videoSrc);

function videoPlay() {
  video.play();
  playB.classList.remove('active');
  pauseB.classList.add('active');
  autoplayL();
}

function videoPause() {
  video.pause();
  pauseB.classList.remove('active');
  playB.classList.add('active');
}

function videoStop() {
  video.pause();
  video.currentTime = 0;
  speed = 1;
  video.playbackRate = speed;
  pauseB.classList.remove('active');
  playB.classList.add('active');
  progressLine.style.width = "0";
  clearTimeout(playT);
}

function speedU() {
  speed *= 2;

  if (speed > 5) {
    speed = 4;
  }

  video.playbackRate = speed;
}

function speedD() {
  speed /= 2;

  if (speed < 0.2) {
    speed = 0.25;
  }

  video.playbackRate = speed;
}

function timeInSecond(even) {
  let hour = Math.floor(even / 360) < 10 ? `0${Math.floor(even / 360)}` : Math.floor(even / 360),
      minutes = Math.floor(even / 60) < 10 ? `0${Math.floor(even / 60)}` : Math.floor(even / 60),
      seconds = Math.floor(even % 60) < 10 ? `0${Math.floor(even % 60)}` : Math.floor(even % 60);

  if (hour == 0) {
    return ` ${minutes} : ${seconds} `;
  } else {
    return `${hour} : ${minutes} : ${seconds} `;
  }
}

function click() {
  if (clickDisplay == 0) {
    clickDisplay = 1;
  } else clickDisplay = 0;
}

function videoVolume(level) {
  level = level == undefined ? volumeLevel.value : level;
  video.volume = level / 100;
}

function autoplayL() {
  progressLine.style.width = `${video.currentTime * 100 / video.duration}%`;
  playTime.innerHTML = `${timeInSecond(Math.floor(video.currentTime))}`;

  if (video.currentTime == video.duration) {
    videoStop();
    clearTimeout(playT);
    return false;
  }

  playT = setTimeout(autoplayL, 1000);
}

function playL(even) {
  let w = progress.offsetWidth,
      e = even.offsetX;
  progressLine.style.width = `${e * 100 / w}%`;
  video.currentTime = video.duration * (e / w);
}

playBtn.addEventListener("click", () => {
  fullTime.innerHTML = timeInSecond(Math.floor(video.duration));
  playBtn.classList.add('active');
  setTimeout(() => {
    panel.classList.add('active');
  }, 500);
  setTimeout(videoPlay, 500);
  videoVolume();
  autoplayL();
  document.addEventListener("keydown", e => {
    if (e.keyCode == 32) {
      e.preventDefault();

      if (clickDisplay == 0) {
        videoPause();
        click();
      } else {
        videoPlay();
        click();
      }
    }
  });
});
video.addEventListener('click', () => {
  if (clickDisplay == 0) {
    click();
    videoPause();
  } else if (clickDisplay == 1) {
    click();
    videoPlay();
  }
});
video.addEventListener('dblclick', e => {
  let rect = video.getBoundingClientRect(),
      left = rect.left;

  if (e.clientX > left && e.clientX < innerWidth / 2) {
    video.currentTime -= 10;
  } else if (e.clientX < innerWidth - left && e.clientX > innerWidth / 2) {
    video.currentTime += 10;
  }
});
pauseB.addEventListener('click', () => {
  videoPause();
  clearTimeout(playT);
  click();
});
playB.addEventListener('click', () => {
  videoPlay();
  autoplayL();
  click();
});
stopB.addEventListener('click', () => {
  videoStop();
});
speedDown.addEventListener('click', () => {
  speedD();
});
speedUp.addEventListener('click', () => {
  speedU();
});
volumeLevel.addEventListener('change', () => {
  videoVolume(volumeLevel.value);

  if (volumeLevel.value == 0) {
    volumeOn.classList.remove('active');
    volumeOff.classList.add('active');
  } else {
    volumeOff.classList.remove('active');
    volumeOn.classList.add('active');
  }
});
volumeOn.addEventListener('click', () => {
  videoVolume(0);
  volumeOn.classList.remove('active');
  volumeOff.classList.add('active');
});
volumeOff.addEventListener('click', () => {
  videoVolume(volumeLevel.value);
  volumeOff.classList.remove('active');
  volumeOn.classList.add('active');
});
progress.addEventListener('click', e => {
  if (clickDisplay == 0) {
    videoPause();
    playL(e);
    videoPlay();
  } else {
    playL(e);
  }
});
progress.addEventListener('mousemove', e => {
  progressHover.style.width = `${e.offsetX * 100 / progress.offsetWidth}%`;
});
progress.addEventListener('mouseleave', e => {
  progressHover.style.width = `0%`;
});
const circle = document.querySelector('.progress__ring-circle'),
      loadPercent = document.querySelector('.progress__load-percent'),
      loadProgress = document.querySelector('.progress__load'),
      body = document.querySelector('body'),
      nav = document.querySelector('.header__nav'),
      radius = circle.r.baseVal.value,
      circleC = Math.round(2 * Math.PI * radius);
circle.style.strokeDasharray = `${circleC} ${circleC}`;
circle.style.strokeDashoffset = circleC;
loadProgress.addEventListener('click', () => {});
document.addEventListener('scroll', () => {
  let percent = Math.round(pageYOffset * 100 / (document.documentElement.scrollHeight - circle.parentElement.clientHeight - nav.clientHeight - 580));

  if (pageYOffset == 0) {
    loadProgress.style.display = "none";
  } else loadProgress.style.display = "flex";

  loadPercent.innerHTML = percent == 0 ? "" : `${percent}%`;
  circleLoad(percent);
});

function circleLoad(percent) {
  let part = circleC - percent / 100 * circleC;
  circle.style.strokeDashoffset = part;
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvbmF2LXN0aWNraW5nLmpzIiwibWFpbi5qcyIsImNvbXBvbmVudHMvc2lkZS1iYXIuanMiLCJjb21wb25lbnRzL3ZpZGVvLXBsYXllci5qcyJdLCJuYW1lcyI6WyJOYXZTdGljayIsImNvbnN0cnVjdG9yIiwic2VsZWN0IiwibmF2IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZWwiLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwidG9wIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsInBhZ2VZT2Zmc2V0IiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwibmF2bCIsIlNpZGVCYXIiLCJvcHRpb24iLCJtZW51IiwiYm9keSIsImUiLCJ0YXJnZXQiLCJuYXZiYXIiLCJwYW5lbCIsInZpZGVvIiwicGxheUJ0biIsInBsYXlUaW1lIiwiZnVsbFRpbWUiLCJwcm9ncmVzcyIsInByb2dyZXNzTGluZSIsInByb2dyZXNzSG92ZXIiLCJwbGF5QiIsInBhdXNlQiIsInN0b3BCIiwic3BlZWREb3duIiwic3BlZWRVcCIsInZvbHVtZU9uIiwidm9sdW1lT2ZmIiwidm9sdW1lTGV2ZWwiLCJkb3dubG9hZCIsInNwZWVkIiwicGxheVQiLCJjbGlja0Rpc3BsYXkiLCJ2aWRlb1NyYyIsImdldEF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInZpZGVvUGxheSIsInBsYXkiLCJhdXRvcGxheUwiLCJ2aWRlb1BhdXNlIiwicGF1c2UiLCJ2aWRlb1N0b3AiLCJjdXJyZW50VGltZSIsInBsYXliYWNrUmF0ZSIsInN0eWxlIiwid2lkdGgiLCJjbGVhclRpbWVvdXQiLCJzcGVlZFUiLCJzcGVlZEQiLCJ0aW1lSW5TZWNvbmQiLCJldmVuIiwiaG91ciIsIk1hdGgiLCJmbG9vciIsIm1pbnV0ZXMiLCJzZWNvbmRzIiwiY2xpY2siLCJ2aWRlb1ZvbHVtZSIsImxldmVsIiwidW5kZWZpbmVkIiwidmFsdWUiLCJ2b2x1bWUiLCJkdXJhdGlvbiIsImlubmVySFRNTCIsInNldFRpbWVvdXQiLCJwbGF5TCIsInciLCJvZmZzZXRXaWR0aCIsIm9mZnNldFgiLCJrZXlDb2RlIiwicHJldmVudERlZmF1bHQiLCJsZWZ0IiwiY2xpZW50WCIsImlubmVyV2lkdGgiLCJjaXJjbGUiLCJsb2FkUGVyY2VudCIsImxvYWRQcm9ncmVzcyIsInJhZGl1cyIsInIiLCJiYXNlVmFsIiwiY2lyY2xlQyIsInJvdW5kIiwiUEkiLCJzdHJva2VEYXNoYXJyYXkiLCJzdHJva2VEYXNob2Zmc2V0IiwicGVyY2VudCIsImRvY3VtZW50RWxlbWVudCIsInNjcm9sbEhlaWdodCIsInBhcmVudEVsZW1lbnQiLCJjbGllbnRIZWlnaHQiLCJkaXNwbGF5IiwiY2lyY2xlTG9hZCIsInBhcnQiXSwibWFwcGluZ3MiOiJBQUFBLE1BQUFBLFFBQUEsQ0FBQTtBQUNBQyxFQUFBQSxXQUFBLENBQUFDLE1BQUEsRUFBQTtBQUNBLFNBQUFDLEdBQUEsR0FBQUMsUUFBQSxDQUFBQyxhQUFBLENBQUFILE1BQUEsQ0FBQUksRUFBQSxDQUFBO0FBQ0EsU0FBQUMsSUFBQSxHQUFBLEtBQUFKLEdBQUEsQ0FBQUsscUJBQUEsRUFBQTtBQUNBLFNBQUFDLEdBQUEsR0FBQSxLQUFBRixJQUFBLENBQUFFLEdBQUE7QUFFQUMsSUFBQUEsTUFBQSxDQUFBQyxnQkFBQSxDQUFBLFFBQUEsRUFBQSxNQUFBO0FBQ0EsVUFBQUMsV0FBQSxHQUFBLENBQUEsRUFBQTtBQUNBLGFBQUFULEdBQUEsQ0FBQVUsU0FBQSxDQUFBQyxHQUFBLENBQUEsT0FBQTtBQUNBLE9BRkEsTUFFQTtBQUNBLGFBQUFYLEdBQUEsQ0FBQVUsU0FBQSxDQUFBRSxNQUFBLENBQUEsT0FBQTtBQUNBO0FBQ0EsS0FOQTtBQU9BOztBQWJBOztBQWdCQSxNQUFBQyxJQUFBLEdBQUEsSUFBQWhCLFFBQUEsQ0FBQTtBQUNBTSxFQUFBQSxFQUFBLEVBQUE7QUFEQSxDQUFBLENBQUE7O0FBS0EsTUFBQVcsT0FBQSxDQUFBO0FBQ0FoQixFQUFBQSxXQUFB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QUFBTSxZQUFBLENBQUEsTUFBQSxFQUFBRixRQUFBOztBQUNBLFNBQUFHLFNBQUEsR0FBQTtBQUNBdEIsRUFBQUEsS0FBQSxDQUFBdUIsSUFBQTtBQUNBaEIsRUFBQUEsS0FBQSxDQUFBbkIsU0FBQSxDQUFBRSxNQUFBLENBQUEsUUFBQTtBQUNBa0IsRUFBQUEsTUFBQSxDQUFBcEIsU0FBQSxDQUFBQyxHQUFBLENBQUEsUUFBQTtBQUNBbUMsRUFBQUEsU0FBQTtBQUNBOztBQUVBLFNBQUFDLFVBQUEsR0FBQTtBQUNBekIsRUFBQUEsS0FBQSxDQUFBMEIsS0FBQTtBQUNBbEIsRUFBQUEsTUFBQSxDQUFBcEIsU0FBQSxDQUFBRSxNQUFBLENBQUEsUUFBQTtBQUNBaUIsRUFBQUEsS0FBQSxDQUFBbkIsU0FBQSxDQUFBQyxHQUFBLENBQUEsUUFBQTtBQUNBOztBQUVBLFNBQUFzQyxTQUFBLEdBQUE7QUFDQTNCLEVBQUFBLEtBQUEsQ0FBQTBCLEtBQUE7QUFDQTFCLEVBQUFBLEtBQUEsQ0FBQTRCLFdBQUEsR0FBQSxDQUFBO0FBQ0FaLEVBQUFBLEtBQUEsR0FBQSxDQUFBO0FBQ0FoQixFQUFBQSxLQUFBLENBQUE2QixZQUFBLEdBQUFiLEtBQUE7QUFDQVIsRUFBQUEsTUFBQSxDQUFBcEIsU0FBQSxDQUFBRSxNQUFBLENBQUEsUUFBQTtBQUNBaUIsRUFBQUEsS0FBQSxDQUFBbkIsU0FBQSxDQUFBQyxHQUFBLENBQUEsUUFBQTtBQUNBZ0IsRUFBQUEsWUFBQSxDQUFBeUIsS0FBQSxDQUFBQyxLQUFBLEdBQUEsR0FBQTtBRDNDQUMsRUFBQUEsWUFBQSxDQUFBZixLQUFBLENBQUE7QUVIQTs7QUFFQSxTQUFBZ0IsTUFBQSxHQUFBO0FBQ0FqQixFQUFBQSxLQUFBLElBQUEsQ0FBQTs7QUFDQSxNQUFBQSxLQUFBLEdBQUEsQ0FBQSxFQUFBO0FBQ0FBLElBQUFBLEtBQUEsR0FBQSxDQUFBO0FBQ0E7O0FBQ0FoQixFQUFBQSxLQUFBLENBQUE2QixZQUFBLEdBQUFiLEtBQUE7QUFDQTs7QUFDQSxTQUFBa0IsTUFBQSxH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QUFBNUUsZ0JBQUEsQ0FBQSxPQUFBLEVBQUEsTUFBQSxDQUVBLENBRkE7QUFJQVAsUUFBQSxDQUFBTyxnQkFBQSxDQUFBLFFBQUEsRUFBQSxNQUFBO0FBQ0EsTUFBQXFGLE9BQUEsR0FBQWpDLElBQUEsQ0FBQTZCLEtBQUEsQ0FBQWhGLFdBQUEsR0FBQSxHQUFBLElBQUFSLFFBQUEsQ0FBQTZGLGVBQUEsQ0FBQUMsWUFBQSxHQUFBYixNQUFBLENBQUFjLGFBQUEsQ0FBQUMsWUFBQSxHQUFBakcsR0FBQSxDQUFBaUcsWUFBQSxHQUFBLEdBQUEsQ0FBQSxDQUFBOztBQUNBLE1BQUF4RixXQUFBLElBQUEsQ0FBQSxFQUFBO0FBQ0EyRSxJQUFBQSxZQUFBLENBQUFoQyxLQUFBLENBQUE4QyxPQUFBLEdBQUEsTUFBQTtBQUNBLEdBRkEsTUFFQWQsWUFBQSxDQUFBaEMsS0FBQSxDQUFBOEMsT0FBQSxHQUFBLE1BQUE7O0FBQ0FmLEVBQUFBLFdBQUEsQ0FBQVosU0FBQSxHQUFBc0IsT0FBQSxJQUFBLENBQUEsR0FBQSxFQUFBLEdBQUEsR0FBQUEsT0FBQSxHQUFBO0FBQ0FNLEVBQUFBLFVBQUEsQ0FBQU4sT0FBQSxDQUFBO0FBQ0EsQ0FQQTs7QUFTQSxTQUFBTSxVQUFBLENBQUFOLE9BQUEsRUFBQTtBQUNBLE1BQUFPLElBQUEsR0FBQVosT0FBQSxHQUFBSyxPQUFBLEdBQUEsR0FBQSxHQUFBTCxPQUFBO0FBQ0FOLEVBQUFBLE1BQUEsQ0FBQTlCLEtBQUEsQ0FBQXdDLGdCQUFBLEdBQUFRLElBQUE7QUFDQSIsImZpbGUiOiJjb21tb24ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgTmF2U3RpY2sge1xyXG4gICAgY29uc3RydWN0b3Ioc2VsZWN0KSB7XHJcbiAgICAgICAgdGhpcy5uYXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdC5lbCk7XHJcbiAgICAgICAgdGhpcy5yZWN0ID0gdGhpcy5uYXYuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgdGhpcy50b3AgPSB0aGlzLnJlY3QudG9wO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCAoKT0+IHsgXHJcbiAgICAgICAgICAgIGlmKHBhZ2VZT2Zmc2V0ID4gMCApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubmF2LmNsYXNzTGlzdC5hZGQoJ2ZpeGVkJykgXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5hdi5jbGFzc0xpc3QucmVtb3ZlKCdmaXhlZCcpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSAgIFxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBuYXZsID0gbmV3IE5hdlN0aWNrICh7XHJcbiAgICBlbDogJy5oZWFkZXJfX25hdidcclxufSlcclxuIFxyXG4gIiwiY2xhc3MgTmF2U3RpY2sge1xyXG4gICAgY29uc3RydWN0b3Ioc2VsZWN0KSB7XHJcbiAgICAgICAgdGhpcy5uYXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdC5lbCk7XHJcbiAgICAgICAgdGhpcy5yZWN0ID0gdGhpcy5uYXYuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgdGhpcy50b3AgPSB0aGlzLnJlY3QudG9wO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCAoKT0+IHsgXHJcbiAgICAgICAgICAgIGlmKHBhZ2VZT2Zmc2V0ID4gMCApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubmF2LmNsYXNzTGlzdC5hZGQoJ2ZpeGVkJykgXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5hdi5jbGFzc0xpc3QucmVtb3ZlKCdmaXhlZCcpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSAgIFxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBuYXZsID0gbmV3IE5hdlN0aWNrICh7XHJcbiAgICBlbDogJy5oZWFkZXJfX25hdidcclxufSlcclxuIFxyXG4gXHJcbmNsYXNzIFNpZGVCYXIgIHtcclxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbikge1xyXG4gICAgICAgIHRoaXMubmF2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihvcHRpb24uZWwpO1xyXG4gICAgICAgIHRoaXMubWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iob3B0aW9uLm1lbnUpO1xyXG4gICAgICAgIHRoaXMuYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcclxuICAgICAgICB0aGlzLm5hdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4ge1xyXG4gICAgICAgICAgICB0aGlzLm1lbnUuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7IFxyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKGUpPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYoZS50YXJnZXQgIT0gdGhpcy5tZW51KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0sIHRydWUpICBcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCk9PiB7IFxyXG4gICAgICAgICAgICB0aGlzLm1lbnUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG5cclxuY29uc3QgbmF2YmFyID0gbmV3IFNpZGVCYXIgKHtcclxuICAgIGVsOiAnLmJ1cmdlcl9fbWVudScsXHJcbiAgICBtZW51OiAnLmhlYWRlcl9fbmF2LXNpZGUnXHJcbn0pXHJcbiBcclxuY29uc3QgICBwYW5lbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3BhbmVsJyksIFxyXG4gICAgICAgIHZpZGVvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZlYXR1cmVzX192aWRlbycpLFxyXG4gICAgICAgIHBsYXlCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmVhdHVyZXNfX3BsYXllci1idG4nKSxcclxuICAgICAgICBwbGF5VGltZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3RpbWUtbm93JyksXHJcbiAgICAgICAgZnVsbFRpbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX190aW1lLWZ1bGwnKSxcclxuICAgICAgICBwcm9ncmVzcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3Byb2dyZXNzJyksXHJcbiAgICAgICAgcHJvZ3Jlc3NMaW5lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fcHJvZ3Jlc3MtbGluZScpLFxyXG4gICAgICAgIHByb2dyZXNzSG92ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19wcm9ncmVzcy1ob3ZlcicpLFxyXG4gICAgICAgIHBsYXlCID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fcGxheU9yUGF1c2UtcGxheScpLFxyXG4gICAgICAgIHBhdXNlQiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3BsYXlPclBhdXNlLXBhdXNlJyksXHJcbiAgICAgICAgc3RvcEIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19zdG9wJyksXHJcbiAgICAgICAgc3BlZWREb3duID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fc3BlZWQtZG93bicpLFxyXG4gICAgICAgIHNwZWVkVXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19zcGVlZC11cCcpLFxyXG4gICAgICAgIHZvbHVtZU9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fdm9sdW1lLW9uJyksXHJcbiAgICAgICAgdm9sdW1lT2ZmID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fdm9sdW1lLW9mZicpLFxyXG4gICAgICAgIHZvbHVtZUxldmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fdm9sdW1lLWxldmVsJyksXHJcbiAgICAgICAgZG93bmxvYWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19kb3dubG9hZCcpOyBcclxuICAgICAgICBcclxubGV0IHNwZWVkID0gMSwgICBcclxuICAgIHBsYXlULFxyXG4gICAgY2xpY2tEaXNwbGF5ID0gMCwgXHJcbiAgICB2aWRlb1NyYyA9IHZpZGVvLmdldEF0dHJpYnV0ZSgnc3JjJyk7ICAgIFxyXG5kb3dubG9hZC5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCB2aWRlb1NyYyk7IFxyXG5mdW5jdGlvbiB2aWRlb1BsYXkoKSB7ICAgXHJcbiAgICB2aWRlby5wbGF5KCk7XHJcbiAgICBwbGF5Qi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsgIFxyXG4gICAgcGF1c2VCLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOyAgXHJcbiAgICBhdXRvcGxheUwoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdmlkZW9QYXVzZSgpIHtcclxuICAgIHZpZGVvLnBhdXNlKCk7XHJcbiAgICBwYXVzZUIuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICBwbGF5Qi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsgXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZpZGVvU3RvcCgpIHsgXHJcbiAgICB2aWRlby5wYXVzZSgpO1xyXG4gICAgdmlkZW8uY3VycmVudFRpbWUgPSAwO1xyXG4gICAgc3BlZWQgPSAxOyAgIFxyXG4gICAgdmlkZW8ucGxheWJhY2tSYXRlID0gc3BlZWQ7XHJcbiAgICBwYXVzZUIuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICBwbGF5Qi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgIHByb2dyZXNzTGluZS5zdHlsZS53aWR0aCA9IFwiMFwiO1xyXG4gICAgY2xlYXJUaW1lb3V0KHBsYXlUKTsgXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNwZWVkVSgpIHtcclxuICAgIHNwZWVkICo9IDI7XHJcbiAgICBpZihzcGVlZCA+IDUpIHtcclxuICAgICAgICBzcGVlZCA9IDQ7XHJcbiAgICB9XHJcbiAgICB2aWRlby5wbGF5YmFja1JhdGUgPSBzcGVlZDsgICAgXHJcbn1cclxuZnVuY3Rpb24gc3BlZWREKCkge1xyXG4gICAgc3BlZWQgLz0gMjtcclxuICAgIGlmKHNwZWVkIDwgMC4yKSB7XHJcbiAgICAgICAgc3BlZWQgPSAwLjI1O1xyXG4gICAgfVxyXG4gICAgdmlkZW8ucGxheWJhY2tSYXRlID0gc3BlZWQ7ICAgXHJcbn0gIFxyXG5mdW5jdGlvbiB0aW1lSW5TZWNvbmQoZXZlbikge1xyXG4gICAgbGV0IGhvdXIgPSBNYXRoLmZsb29yKGV2ZW4vMzYwKSA8IDEwID8gYDAke01hdGguZmxvb3IoZXZlbi8zNjApfWAgOiBNYXRoLmZsb29yKGV2ZW4vMzYwKSxcclxuICAgICAgICBtaW51dGVzID0gIE1hdGguZmxvb3IoZXZlbi82MCkgPCAxMCA/IGAwJHtNYXRoLmZsb29yKGV2ZW4vNjApfWAgOiBNYXRoLmZsb29yKGV2ZW4vNjApLFxyXG4gICAgICAgIHNlY29uZHMgPSBNYXRoLmZsb29yKGV2ZW4lNjApIDwgMTAgPyBgMCR7TWF0aC5mbG9vcihldmVuJTYwKX1gIDogTWF0aC5mbG9vcihldmVuJTYwKTtcclxuICAgIGlmKGhvdXIgPT0gMCkge1xyXG4gICAgICAgIHJldHVybiBgICR7bWludXRlc30gOiAke3NlY29uZHN9IGA7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBgJHtob3VyfSA6ICR7bWludXRlc30gOiAke3NlY29uZHN9IGA7XHJcbiAgICB9IFxyXG59XHJcbmZ1bmN0aW9uIGNsaWNrKCkge1xyXG4gICAgaWYoY2xpY2tEaXNwbGF5ID09IDApIHtcclxuICAgICAgICBjbGlja0Rpc3BsYXkgPSAxXHJcbiAgICB9ZWxzZSBjbGlja0Rpc3BsYXkgPSAwXHJcbn1cclxuIFxyXG5mdW5jdGlvbiB2aWRlb1ZvbHVtZShsZXZlbCkgeyBcclxuICAgIGxldmVsID0gbGV2ZWwgPT0gdW5kZWZpbmVkID8gdm9sdW1lTGV2ZWwudmFsdWUgOiBsZXZlbDtcclxuICAgIHZpZGVvLnZvbHVtZSA9IGxldmVsIC8gMTAwOyAgICBcclxufSBcclxuZnVuY3Rpb24gYXV0b3BsYXlMKCkgeyAgXHJcbiAgICBwcm9ncmVzc0xpbmUuc3R5bGUud2lkdGggPSBgJHsodmlkZW8uY3VycmVudFRpbWUqMTAwKS92aWRlby5kdXJhdGlvbn0lYDsgXHJcbiAgICBwbGF5VGltZS5pbm5lckhUTUwgPSBgJHt0aW1lSW5TZWNvbmQoTWF0aC5mbG9vcih2aWRlby5jdXJyZW50VGltZSkpfWA7ICBcclxuICAgIFxyXG4gICAgaWYodmlkZW8uY3VycmVudFRpbWUgPT0gdmlkZW8uZHVyYXRpb24pIHtcclxuICAgICAgICB2aWRlb1N0b3AoKSBcclxuICAgICAgICBjbGVhclRpbWVvdXQocGxheVQpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHBsYXlUID0gc2V0VGltZW91dCAoYXV0b3BsYXlMLCAxMDAwKTsgIFxyXG4gICAgXHJcbn1cclxuZnVuY3Rpb24gcGxheUwoZXZlbikge1xyXG4gICAgbGV0IHcgPSBwcm9ncmVzcy5vZmZzZXRXaWR0aCxcclxuICAgICAgICBlID0gZXZlbi5vZmZzZXRYOyAgXHJcbiAgICBwcm9ncmVzc0xpbmUuc3R5bGUud2lkdGggPSBgJHsoZSoxMDApL3d9JWA7XHJcbiAgICB2aWRlby5jdXJyZW50VGltZSA9IHZpZGVvLmR1cmF0aW9uICogKGUvdyk7XHJcbn1cclxucGxheUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCk9PiB7XHJcbiAgICBmdWxsVGltZS5pbm5lckhUTUwgPSB0aW1lSW5TZWNvbmQoIE1hdGguZmxvb3IodmlkZW8uZHVyYXRpb24pKTsgXHJcbiAgICBwbGF5QnRuLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOyBcclxuICAgIHNldFRpbWVvdXQoKCk9PiB7cGFuZWwuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyl9LCA1MDApOyAgXHJcbiAgICBzZXRUaW1lb3V0KHZpZGVvUGxheSwgNTAwKTsgIFxyXG4gICAgdmlkZW9Wb2x1bWUoKTtcclxuICAgIGF1dG9wbGF5TCgpOyBcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKT0+IHsgIFxyXG4gICAgICAgIGlmKGUua2V5Q29kZSA9PSAzMil7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgaWYoY2xpY2tEaXNwbGF5ID09IDApIHtcclxuICAgICAgICAgICAgdmlkZW9QYXVzZSgpO1xyXG4gICAgICAgICAgICBjbGljaygpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZpZGVvUGxheSgpO1xyXG4gICAgICAgICAgICBjbGljaygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgICAgICBcclxuICAgfSlcclxufSkgXHJcbnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7XHJcbiAgICBpZihjbGlja0Rpc3BsYXkgPT0gMCl7XHJcbiAgICAgICAgY2xpY2soKTtcclxuICAgICAgICB2aWRlb1BhdXNlKCk7XHJcbiAgICB9IGVsc2UgaWYgKGNsaWNrRGlzcGxheSA9PSAxKXtcclxuICAgICAgICBjbGljaygpO1xyXG4gICAgICAgIHZpZGVvUGxheSgpO1xyXG4gICAgfVxyXG59KVxyXG5cclxudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignZGJsY2xpY2snLCAoZSk9PiB7XHJcbiAgICBsZXQgcmVjdCA9IHZpZGVvLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxyXG4gICAgICAgIGxlZnQgPSByZWN0LmxlZnQ7XHJcbiAgICBpZihlLmNsaWVudFggPiBsZWZ0ICYmIGUuY2xpZW50WCA8IGlubmVyV2lkdGgvMikge1xyXG4gICAgICAgIHZpZGVvLmN1cnJlbnRUaW1lIC09IDEwXHJcbiAgICB9IGVsc2UgaWYgKGUuY2xpZW50WCA8IGlubmVyV2lkdGggLSBsZWZ0ICYmIGUuY2xpZW50WCA+IGlubmVyV2lkdGgvMil7XHJcbiAgICAgICAgdmlkZW8uY3VycmVudFRpbWUgKz0gMTBcclxuICAgIH1cclxuICAgIFxyXG59KVxyXG4gXHJcbnBhdXNlQi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4ge1xyXG4gICAgdmlkZW9QYXVzZSgpOyBcclxuICAgIGNsZWFyVGltZW91dChwbGF5VCk7XHJcbiAgICBjbGljaygpO1xyXG59KVxyXG5cclxucGxheUIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHtcclxuICAgIHZpZGVvUGxheSgpO1xyXG4gICAgYXV0b3BsYXlMKCk7XHJcbiAgICBjbGljaygpO1xyXG59KVxyXG5cclxuc3RvcEIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHtcclxuICAgIHZpZGVvU3RvcCgpOyBcclxufSlcclxuXHJcbnNwZWVkRG93bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4geyAgXHJcbiAgICBzcGVlZEQoKTtcclxufSlcclxuc3BlZWRVcC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4geyAgXHJcbiAgICBzcGVlZFUoKTtcclxufSlcclxuXHJcbnZvbHVtZUxldmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpPT4geyAgXHJcbiAgICB2aWRlb1ZvbHVtZSh2b2x1bWVMZXZlbC52YWx1ZSk7XHJcbiAgICBpZih2b2x1bWVMZXZlbC52YWx1ZSA9PSAwICkge1xyXG4gICAgICAgIHZvbHVtZU9uLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgICAgIHZvbHVtZU9mZi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdm9sdW1lT2ZmLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgICAgIHZvbHVtZU9uLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgfVxyXG59KVxyXG5cclxudm9sdW1lT24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHtcclxuICAgIHZpZGVvVm9sdW1lKDApOyBcclxuICAgIHZvbHVtZU9uLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgdm9sdW1lT2ZmLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG59KVxyXG5cclxudm9sdW1lT2ZmLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7XHJcbiAgICB2aWRlb1ZvbHVtZSh2b2x1bWVMZXZlbC52YWx1ZSk7IFxyXG4gICAgdm9sdW1lT2ZmLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgdm9sdW1lT24uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbn0pXHJcblxyXG5wcm9ncmVzcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKT0+IHtcclxuICAgIGlmKGNsaWNrRGlzcGxheSA9PSAwKXtcclxuICAgICAgICB2aWRlb1BhdXNlKCk7XHJcbiAgICAgICAgcGxheUwoZSk7XHJcbiAgICAgICAgdmlkZW9QbGF5KCk7IFxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBwbGF5TChlKTsgXHJcbiAgICB9XHJcbiAgIFxyXG59KVxyXG5cclxucHJvZ3Jlc3MuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgKGUpPT4geyAgXHJcbiAgICBwcm9ncmVzc0hvdmVyLnN0eWxlLndpZHRoID0gYCR7KGUub2Zmc2V0WCoxMDApL3Byb2dyZXNzLm9mZnNldFdpZHRofSVgO1xyXG59KVxyXG5wcm9ncmVzcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKGUpPT4geyAgXHJcbiAgICBwcm9ncmVzc0hvdmVyLnN0eWxlLndpZHRoID0gYDAlYDtcclxufSlcclxuIFxyXG4gXHJcbmNvbnN0ICAgY2lyY2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2dyZXNzX19yaW5nLWNpcmNsZScpLFxyXG4gICAgICAgIGxvYWRQZXJjZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2dyZXNzX19sb2FkLXBlcmNlbnQnKSwgXHJcbiAgICAgICAgbG9hZFByb2dyZXNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2dyZXNzX19sb2FkJyksIFxyXG4gICAgICAgIGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JyksXHJcbiAgICAgICAgbmF2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9fbmF2JyksXHJcbiAgICAgICAgcmFkaXVzID0gY2lyY2xlLnIuYmFzZVZhbC52YWx1ZSxcclxuICAgICAgICBjaXJjbGVDID0gTWF0aC5yb3VuZCgyICogTWF0aC5QSSAqIHJhZGl1cyk7IFxyXG5jaXJjbGUuc3R5bGUuc3Ryb2tlRGFzaGFycmF5ID0gYCR7Y2lyY2xlQ30gJHtjaXJjbGVDfWA7IFxyXG5jaXJjbGUuc3R5bGUuc3Ryb2tlRGFzaG9mZnNldCA9IGNpcmNsZUMgOyBcclxuXHJcbmxvYWRQcm9ncmVzcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4geyBcclxuICAgIFxyXG59KVxyXG5cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJyAsICgpPT4geyAgXHJcbiAgICBsZXQgcGVyY2VudCA9IE1hdGgucm91bmQocGFnZVlPZmZzZXQgKiAxMDAgLyAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbEhlaWdodCAtIGNpcmNsZS5wYXJlbnRFbGVtZW50LmNsaWVudEhlaWdodCAtIG5hdi5jbGllbnRIZWlnaHQgLSA1ODAgKSk7XHJcbiAgICBpZihwYWdlWU9mZnNldCA9PSAwICl7XHJcbiAgICAgICAgbG9hZFByb2dyZXNzLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIiBcclxuICAgIH0gZWxzZSAgbG9hZFByb2dyZXNzLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIiBcclxuICAgIGxvYWRQZXJjZW50LmlubmVySFRNTCA9ICBwZXJjZW50ICA9PSAwID8gXCJcIiA6IGAkeyBwZXJjZW50fSVgO1xyXG4gICAgY2lyY2xlTG9hZChwZXJjZW50KTtcclxufSlcclxuICAgIFxyXG4gZnVuY3Rpb24gY2lyY2xlTG9hZChwZXJjZW50KSB7XHJcbiAgICAgbGV0IHBhcnQgPSBjaXJjbGVDIC0gcGVyY2VudCAvIDEwMCAqIGNpcmNsZUM7XHJcbiAgICAgY2lyY2xlLnN0eWxlLnN0cm9rZURhc2hvZmZzZXQgPSBwYXJ0IDtcclxuICAgfVxyXG4gXHJcblxyXG5cclxuXHJcbiBcclxuIiwiY2xhc3MgU2lkZUJhciAge1xyXG4gICAgY29uc3RydWN0b3Iob3B0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5uYXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG9wdGlvbi5lbCk7XHJcbiAgICAgICAgdGhpcy5tZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihvcHRpb24ubWVudSk7XHJcbiAgICAgICAgdGhpcy5ib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xyXG4gICAgICAgIHRoaXMubmF2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7XHJcbiAgICAgICAgICAgIHRoaXMubWVudS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsgXHJcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCAoZSk9PiB7XHJcbiAgICAgICAgICAgICAgICBpZihlLnRhcmdldCAhPSB0aGlzLm1lbnUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbnUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSwgdHJ1ZSkgIFxyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKT0+IHsgXHJcbiAgICAgICAgICAgIHRoaXMubWVudS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBuYXZiYXIgPSBuZXcgU2lkZUJhciAoe1xyXG4gICAgZWw6ICcuYnVyZ2VyX19tZW51JyxcclxuICAgIG1lbnU6ICcuaGVhZGVyX19uYXYtc2lkZSdcclxufSlcclxuICIsImNvbnN0ICAgcGFuZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19wYW5lbCcpLCBcclxuICAgICAgICB2aWRlbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mZWF0dXJlc19fdmlkZW8nKSxcclxuICAgICAgICBwbGF5QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZlYXR1cmVzX19wbGF5ZXItYnRuJyksXHJcbiAgICAgICAgcGxheVRpbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX190aW1lLW5vdycpLFxyXG4gICAgICAgIGZ1bGxUaW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fdGltZS1mdWxsJyksXHJcbiAgICAgICAgcHJvZ3Jlc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19wcm9ncmVzcycpLFxyXG4gICAgICAgIHByb2dyZXNzTGluZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3Byb2dyZXNzLWxpbmUnKSxcclxuICAgICAgICBwcm9ncmVzc0hvdmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fcHJvZ3Jlc3MtaG92ZXInKSxcclxuICAgICAgICBwbGF5QiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3BsYXlPclBhdXNlLXBsYXknKSxcclxuICAgICAgICBwYXVzZUIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19wbGF5T3JQYXVzZS1wYXVzZScpLFxyXG4gICAgICAgIHN0b3BCID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fc3RvcCcpLFxyXG4gICAgICAgIHNwZWVkRG93biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3NwZWVkLWRvd24nKSxcclxuICAgICAgICBzcGVlZFVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fc3BlZWQtdXAnKSxcclxuICAgICAgICB2b2x1bWVPbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3ZvbHVtZS1vbicpLFxyXG4gICAgICAgIHZvbHVtZU9mZiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3ZvbHVtZS1vZmYnKSxcclxuICAgICAgICB2b2x1bWVMZXZlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3ZvbHVtZS1sZXZlbCcpLFxyXG4gICAgICAgIGRvd25sb2FkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fZG93bmxvYWQnKTsgXHJcbiAgICAgICAgXHJcbmxldCBzcGVlZCA9IDEsICAgXHJcbiAgICBwbGF5VCxcclxuICAgIGNsaWNrRGlzcGxheSA9IDAsIFxyXG4gICAgdmlkZW9TcmMgPSB2aWRlby5nZXRBdHRyaWJ1dGUoJ3NyYycpOyAgICBcclxuZG93bmxvYWQuc2V0QXR0cmlidXRlKCdocmVmJywgdmlkZW9TcmMpOyBcclxuZnVuY3Rpb24gdmlkZW9QbGF5KCkgeyAgIFxyXG4gICAgdmlkZW8ucGxheSgpO1xyXG4gICAgcGxheUIuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7ICBcclxuICAgIHBhdXNlQi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsgIFxyXG4gICAgYXV0b3BsYXlMKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZpZGVvUGF1c2UoKSB7XHJcbiAgICB2aWRlby5wYXVzZSgpO1xyXG4gICAgcGF1c2VCLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgcGxheUIuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7IFxyXG59XHJcblxyXG5mdW5jdGlvbiB2aWRlb1N0b3AoKSB7IFxyXG4gICAgdmlkZW8ucGF1c2UoKTtcclxuICAgIHZpZGVvLmN1cnJlbnRUaW1lID0gMDtcclxuICAgIHNwZWVkID0gMTsgICBcclxuICAgIHZpZGVvLnBsYXliYWNrUmF0ZSA9IHNwZWVkO1xyXG4gICAgcGF1c2VCLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgcGxheUIuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICBwcm9ncmVzc0xpbmUuc3R5bGUud2lkdGggPSBcIjBcIjtcclxuICAgIGNsZWFyVGltZW91dChwbGF5VCk7IFxyXG59XHJcblxyXG5mdW5jdGlvbiBzcGVlZFUoKSB7XHJcbiAgICBzcGVlZCAqPSAyO1xyXG4gICAgaWYoc3BlZWQgPiA1KSB7XHJcbiAgICAgICAgc3BlZWQgPSA0O1xyXG4gICAgfVxyXG4gICAgdmlkZW8ucGxheWJhY2tSYXRlID0gc3BlZWQ7ICAgIFxyXG59XHJcbmZ1bmN0aW9uIHNwZWVkRCgpIHtcclxuICAgIHNwZWVkIC89IDI7XHJcbiAgICBpZihzcGVlZCA8IDAuMikge1xyXG4gICAgICAgIHNwZWVkID0gMC4yNTtcclxuICAgIH1cclxuICAgIHZpZGVvLnBsYXliYWNrUmF0ZSA9IHNwZWVkOyAgIFxyXG59ICBcclxuZnVuY3Rpb24gdGltZUluU2Vjb25kKGV2ZW4pIHtcclxuICAgIGxldCBob3VyID0gTWF0aC5mbG9vcihldmVuLzM2MCkgPCAxMCA/IGAwJHtNYXRoLmZsb29yKGV2ZW4vMzYwKX1gIDogTWF0aC5mbG9vcihldmVuLzM2MCksXHJcbiAgICAgICAgbWludXRlcyA9ICBNYXRoLmZsb29yKGV2ZW4vNjApIDwgMTAgPyBgMCR7TWF0aC5mbG9vcihldmVuLzYwKX1gIDogTWF0aC5mbG9vcihldmVuLzYwKSxcclxuICAgICAgICBzZWNvbmRzID0gTWF0aC5mbG9vcihldmVuJTYwKSA8IDEwID8gYDAke01hdGguZmxvb3IoZXZlbiU2MCl9YCA6IE1hdGguZmxvb3IoZXZlbiU2MCk7XHJcbiAgICBpZihob3VyID09IDApIHtcclxuICAgICAgICByZXR1cm4gYCAke21pbnV0ZXN9IDogJHtzZWNvbmRzfSBgO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gYCR7aG91cn0gOiAke21pbnV0ZXN9IDogJHtzZWNvbmRzfSBgO1xyXG4gICAgfSBcclxufVxyXG5mdW5jdGlvbiBjbGljaygpIHtcclxuICAgIGlmKGNsaWNrRGlzcGxheSA9PSAwKSB7XHJcbiAgICAgICAgY2xpY2tEaXNwbGF5ID0gMVxyXG4gICAgfWVsc2UgY2xpY2tEaXNwbGF5ID0gMFxyXG59XHJcbiBcclxuZnVuY3Rpb24gdmlkZW9Wb2x1bWUobGV2ZWwpIHsgXHJcbiAgICBsZXZlbCA9IGxldmVsID09IHVuZGVmaW5lZCA/IHZvbHVtZUxldmVsLnZhbHVlIDogbGV2ZWw7XHJcbiAgICB2aWRlby52b2x1bWUgPSBsZXZlbCAvIDEwMDsgICAgXHJcbn0gXHJcbmZ1bmN0aW9uIGF1dG9wbGF5TCgpIHsgIFxyXG4gICAgcHJvZ3Jlc3NMaW5lLnN0eWxlLndpZHRoID0gYCR7KHZpZGVvLmN1cnJlbnRUaW1lKjEwMCkvdmlkZW8uZHVyYXRpb259JWA7IFxyXG4gICAgcGxheVRpbWUuaW5uZXJIVE1MID0gYCR7dGltZUluU2Vjb25kKE1hdGguZmxvb3IodmlkZW8uY3VycmVudFRpbWUpKX1gOyAgXHJcbiAgICBcclxuICAgIGlmKHZpZGVvLmN1cnJlbnRUaW1lID09IHZpZGVvLmR1cmF0aW9uKSB7XHJcbiAgICAgICAgdmlkZW9TdG9wKCkgXHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHBsYXlUKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBwbGF5VCA9IHNldFRpbWVvdXQgKGF1dG9wbGF5TCwgMTAwMCk7ICBcclxuICAgIFxyXG59XHJcbmZ1bmN0aW9uIHBsYXlMKGV2ZW4pIHtcclxuICAgIGxldCB3ID0gcHJvZ3Jlc3Mub2Zmc2V0V2lkdGgsXHJcbiAgICAgICAgZSA9IGV2ZW4ub2Zmc2V0WDsgIFxyXG4gICAgcHJvZ3Jlc3NMaW5lLnN0eWxlLndpZHRoID0gYCR7KGUqMTAwKS93fSVgO1xyXG4gICAgdmlkZW8uY3VycmVudFRpbWUgPSB2aWRlby5kdXJhdGlvbiAqIChlL3cpO1xyXG59XHJcbnBsYXlCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpPT4ge1xyXG4gICAgZnVsbFRpbWUuaW5uZXJIVE1MID0gdGltZUluU2Vjb25kKCBNYXRoLmZsb29yKHZpZGVvLmR1cmF0aW9uKSk7IFxyXG4gICAgcGxheUJ0bi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsgXHJcbiAgICBzZXRUaW1lb3V0KCgpPT4ge3BhbmVsLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpfSwgNTAwKTsgIFxyXG4gICAgc2V0VGltZW91dCh2aWRlb1BsYXksIDUwMCk7ICBcclxuICAgIHZpZGVvVm9sdW1lKCk7XHJcbiAgICBhdXRvcGxheUwoKTsgXHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSk9PiB7ICBcclxuICAgICAgICBpZihlLmtleUNvZGUgPT0gMzIpe1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGlmKGNsaWNrRGlzcGxheSA9PSAwKSB7XHJcbiAgICAgICAgICAgIHZpZGVvUGF1c2UoKTtcclxuICAgICAgICAgICAgY2xpY2soKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2aWRlb1BsYXkoKTtcclxuICAgICAgICAgICAgY2xpY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAgICAgXHJcbiAgIH0pXHJcbn0pIFxyXG52aWRlby5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4ge1xyXG4gICAgaWYoY2xpY2tEaXNwbGF5ID09IDApe1xyXG4gICAgICAgIGNsaWNrKCk7XHJcbiAgICAgICAgdmlkZW9QYXVzZSgpO1xyXG4gICAgfSBlbHNlIGlmIChjbGlja0Rpc3BsYXkgPT0gMSl7XHJcbiAgICAgICAgY2xpY2soKTtcclxuICAgICAgICB2aWRlb1BsYXkoKTtcclxuICAgIH1cclxufSlcclxuXHJcbnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgKGUpPT4ge1xyXG4gICAgbGV0IHJlY3QgPSB2aWRlby5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcclxuICAgICAgICBsZWZ0ID0gcmVjdC5sZWZ0O1xyXG4gICAgaWYoZS5jbGllbnRYID4gbGVmdCAmJiBlLmNsaWVudFggPCBpbm5lcldpZHRoLzIpIHtcclxuICAgICAgICB2aWRlby5jdXJyZW50VGltZSAtPSAxMFxyXG4gICAgfSBlbHNlIGlmIChlLmNsaWVudFggPCBpbm5lcldpZHRoIC0gbGVmdCAmJiBlLmNsaWVudFggPiBpbm5lcldpZHRoLzIpe1xyXG4gICAgICAgIHZpZGVvLmN1cnJlbnRUaW1lICs9IDEwXHJcbiAgICB9XHJcbiAgICBcclxufSlcclxuIFxyXG5wYXVzZUIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHtcclxuICAgIHZpZGVvUGF1c2UoKTsgXHJcbiAgICBjbGVhclRpbWVvdXQocGxheVQpO1xyXG4gICAgY2xpY2soKTtcclxufSlcclxuXHJcbnBsYXlCLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7XHJcbiAgICB2aWRlb1BsYXkoKTtcclxuICAgIGF1dG9wbGF5TCgpO1xyXG4gICAgY2xpY2soKTtcclxufSlcclxuXHJcbnN0b3BCLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7XHJcbiAgICB2aWRlb1N0b3AoKTsgXHJcbn0pXHJcblxyXG5zcGVlZERvd24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHsgIFxyXG4gICAgc3BlZWREKCk7XHJcbn0pXHJcbnNwZWVkVXAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHsgIFxyXG4gICAgc3BlZWRVKCk7XHJcbn0pXHJcblxyXG52b2x1bWVMZXZlbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKT0+IHsgIFxyXG4gICAgdmlkZW9Wb2x1bWUodm9sdW1lTGV2ZWwudmFsdWUpO1xyXG4gICAgaWYodm9sdW1lTGV2ZWwudmFsdWUgPT0gMCApIHtcclxuICAgICAgICB2b2x1bWVPbi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICB2b2x1bWVPZmYuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHZvbHVtZU9mZi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICB2b2x1bWVPbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgIH1cclxufSlcclxuXHJcbnZvbHVtZU9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7XHJcbiAgICB2aWRlb1ZvbHVtZSgwKTsgXHJcbiAgICB2b2x1bWVPbi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgIHZvbHVtZU9mZi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxufSlcclxuXHJcbnZvbHVtZU9mZi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4ge1xyXG4gICAgdmlkZW9Wb2x1bWUodm9sdW1lTGV2ZWwudmFsdWUpOyBcclxuICAgIHZvbHVtZU9mZi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgIHZvbHVtZU9uLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG59KVxyXG5cclxucHJvZ3Jlc3MuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSk9PiB7XHJcbiAgICBpZihjbGlja0Rpc3BsYXkgPT0gMCl7XHJcbiAgICAgICAgdmlkZW9QYXVzZSgpO1xyXG4gICAgICAgIHBsYXlMKGUpO1xyXG4gICAgICAgIHZpZGVvUGxheSgpOyBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcGxheUwoZSk7IFxyXG4gICAgfVxyXG4gICBcclxufSlcclxuXHJcbnByb2dyZXNzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIChlKT0+IHsgIFxyXG4gICAgcHJvZ3Jlc3NIb3Zlci5zdHlsZS53aWR0aCA9IGAkeyhlLm9mZnNldFgqMTAwKS9wcm9ncmVzcy5vZmZzZXRXaWR0aH0lYDtcclxufSlcclxucHJvZ3Jlc3MuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIChlKT0+IHsgIFxyXG4gICAgcHJvZ3Jlc3NIb3Zlci5zdHlsZS53aWR0aCA9IGAwJWA7XHJcbn0pXHJcbiBcclxuICJdfQ==
