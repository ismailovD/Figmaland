class NavStick {
  constructor(select) {
    this.nav = document.querySelector(select.el);
    this.rect = this.nav.getBoundingClientRect();
    this.top = this.rect.top;
    window.addEventListener('scroll', () => {
      if (pageYOffset > 0) {
        this.nav.classList.add('fixed');
      } else {
        this.nav.classList.remove('fixed');
      }
    });
  }

}

const navl = new NavStick({
  el: '.header__nav'
});

class SideBar {
  constructor(option) {
    this.nav = document.querySelector(option.el);
    this.menu = document.querySelector(option.menu);
    this.body = document.querySelector('body');
    this.nav.addEventListener('click', () => {
      this.menu.classList.add('active');
      document.addEventListener('mouseup', e => {
        if (e.target != this.menu) {
          this.menu.classList.remove('active');
        }
      });
    }, true);
    window.addEventListener('resize', () => {
      this.menu.classList.remove('active');
    });
  }

}

const navbar = new SideBar({
  el: '.burger__menu',
  menu: '.header__nav-side'
});
const panel = document.querySelector('.player__panel'),
      video = document.querySelector('.features__video'),
      playBtn = document.querySelector('.features__player-btn'),
      playTime = document.querySelector('.player__time-now'),
      fullTime = document.querySelector('.player__time-full'),
      progress = document.querySelector('.player__progress'),
      progressLine = document.querySelector('.player__progress-line'),
      progressHover = document.querySelector('.player__progress-hover'),
      playB = document.querySelector('.player__playOrPause-play'),
      pauseB = document.querySelector('.player__playOrPause-pause'),
      stopB = document.querySelector('.player__stop'),
      speedDown = document.querySelector('.player__speed-down'),
      speedUp = document.querySelector('.player__speed-up'),
      volumeOn = document.querySelector('.player__volume-on'),
      volumeOff = document.querySelector('.player__volume-off'),
      volumeLevel = document.querySelector('.player__volume-level'),
      download = document.querySelector('.player__download');
let speed = 1,
    playT,
    clickDisplay = 0,
    videoSrc = video.getAttribute('src');
download.setAttribute('href', videoSrc);

function videoPlay() {
  video.play();
  playB.classList.remove('active');
  pauseB.classList.add('active');
  autoplayL();
}

function videoPause() {
  video.pause();
  pauseB.classList.remove('active');
  playB.classList.add('active');
}

function videoStop() {
  video.pause();
  video.currentTime = 0;
  speed = 1;
  video.playbackRate = speed;
  pauseB.classList.remove('active');
  playB.classList.add('active');
  progressLine.style.width = "0";
  clearTimeout(playT);
}

function speedU() {
  speed *= 2;

  if (speed > 5) {
    speed = 4;
  }

  video.playbackRate = speed;
}

function speedD() {
  speed /= 2;

  if (speed < 0.2) {
    speed = 0.25;
  }

  video.playbackRate = speed;
}

function timeInSecond(even) {
  let hour = Math.floor(even / 360) < 10 ? `0${Math.floor(even / 360)}` : Math.floor(even / 360),
      minutes = Math.floor(even / 60) < 10 ? `0${Math.floor(even / 60)}` : Math.floor(even / 60),
      seconds = Math.floor(even % 60) < 10 ? `0${Math.floor(even % 60)}` : Math.floor(even % 60);

  if (hour == 0) {
    return ` ${minutes} : ${seconds} `;
  } else {
    return `${hour} : ${minutes} : ${seconds} `;
  }
}

function click() {
  if (clickDisplay == 0) {
    clickDisplay = 1;
  } else clickDisplay = 0;
}

function videoVolume(level) {
  level = level == undefined ? volumeLevel.value : level;
  video.volume = level / 100;
}

function autoplayL() {
  progressLine.style.width = `${video.currentTime * 100 / video.duration}%`;
  playTime.innerHTML = `${timeInSecond(Math.floor(video.currentTime))}`;

  if (video.currentTime == video.duration) {
    videoStop();
    clearTimeout(playT);
    return false;
  }

  playT = setTimeout(autoplayL, 1000);
}

function playL(even) {
  let w = progress.offsetWidth,
      e = even.offsetX;
  progressLine.style.width = `${e * 100 / w}%`;
  video.currentTime = video.duration * (e / w);
}

playBtn.addEventListener("click", () => {
  fullTime.innerHTML = timeInSecond(Math.floor(video.duration));
  playBtn.classList.add('active');
  setTimeout(() => {
    panel.classList.add('active');
  }, 500);
  setTimeout(videoPlay, 500);
  videoVolume();
  autoplayL();
  document.addEventListener("keydown", e => {
    if (e.keyCode == 32) {
      e.preventDefault();

      if (clickDisplay == 0) {
        videoPause();
        click();
      } else {
        videoPlay();
        click();
      }
    }
  });
});
video.addEventListener('click', () => {
  if (clickDisplay == 0) {
    click();
    videoPause();
  } else if (clickDisplay == 1) {
    click();
    videoPlay();
  }
});
video.addEventListener('dblclick', e => {
  let rect = video.getBoundingClientRect(),
      left = rect.left;

  if (e.clientX > left && e.clientX < innerWidth / 2) {
    video.currentTime -= 10;
  } else if (e.clientX < innerWidth - left && e.clientX > innerWidth / 2) {
    video.currentTime += 10;
  }
});
pauseB.addEventListener('click', () => {
  videoPause();
  clearTimeout(playT);
  click();
});
playB.addEventListener('click', () => {
  videoPlay();
  autoplayL();
  click();
});
stopB.addEventListener('click', () => {
  videoStop();
});
speedDown.addEventListener('click', () => {
  speedD();
});
speedUp.addEventListener('click', () => {
  speedU();
});
volumeLevel.addEventListener('change', () => {
  videoVolume(volumeLevel.value);

  if (volumeLevel.value == 0) {
    volumeOn.classList.remove('active');
    volumeOff.classList.add('active');
  } else {
    volumeOff.classList.remove('active');
    volumeOn.classList.add('active');
  }
});
volumeOn.addEventListener('click', () => {
  videoVolume(0);
  volumeOn.classList.remove('active');
  volumeOff.classList.add('active');
});
volumeOff.addEventListener('click', () => {
  videoVolume(volumeLevel.value);
  volumeOff.classList.remove('active');
  volumeOn.classList.add('active');
});
progress.addEventListener('click', e => {
  if (clickDisplay == 0) {
    videoPause();
    playL(e);
    videoPlay();
  } else {
    playL(e);
  }
});
progress.addEventListener('mousemove', e => {
  progressHover.style.width = `${e.offsetX * 100 / progress.offsetWidth}%`;
});
progress.addEventListener('mouseleave', e => {
  progressHover.style.width = `0%`;
});
const circle = document.querySelector('.progress__ring-circle'),
      loadPercent = document.querySelector('.progress__load-percent'),
      loadProgress = document.querySelector('.progress__load'),
      body = document.querySelector('body'),
      nav = document.querySelector('.header__nav'),
      radius = circle.r.baseVal.value,
      circleC = Math.round(2 * Math.PI * radius);
circle.style.strokeDasharray = `${circleC} ${circleC}`;
circle.style.strokeDashoffset = circleC;
loadProgress.addEventListener('click', () => {});
document.addEventListener('scroll', () => {
  let windowScroll = pageYOffset,
      windowHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight,
      percent = Math.round(windowScroll / windowHeight * 100);

  if (pageYOffset == 0) {
    loadProgress.style.display = "none";
  } else loadProgress.style.display = "flex";

  loadPercent.innerHTML = percent == 0 ? "" : `${percent}%`;
  circleLoad(percent);
});

function circleLoad(percent) {
  let part = circleC - percent / 100 * circleC;
  circle.style.strokeDashoffset = part;
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvbmF2LXN0aWNraW5nLmpzIiwibWFpbi5qcyIsImNvbXBvbmVudHMvc2lkZS1iYXIuanMiLCJjb21wb25lbnRzL3ZpZGVvLXBsYXllci5qcyJdLCJuYW1lcyI6WyJOYXZTdGljayIsImNvbnN0cnVjdG9yIiwic2VsZWN0IiwibmF2IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZWwiLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwidG9wIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsInBhZ2VZT2Zmc2V0IiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwibmF2bCIsIlNpZGVCYXIiLCJvcHRpb24iLCJtZW51IiwiYm9keSIsImUiLCJ0YXJnZXQiLCJuYXZiYXIiLCJwYW5lbCIsInZpZGVvIiwicGxheUJ0biIsInBsYXlUaW1lIiwiZnVsbFRpbWUiLCJwcm9ncmVzcyIsInByb2dyZXNzTGluZSIsInByb2dyZXNzSG92ZXIiLCJwbGF5QiIsInBhdXNlQiIsInN0b3BCIiwic3BlZWREb3duIiwic3BlZWRVcCIsInZvbHVtZU9uIiwidm9sdW1lT2ZmIiwidm9sdW1lTGV2ZWwiLCJkb3dubG9hZCIsInNwZWVkIiwicGxheVQiLCJjbGlja0Rpc3BsYXkiLCJ2aWRlb1NyYyIsImdldEF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInZpZGVvUGxheSIsInBsYXkiLCJhdXRvcGxheUwiLCJ2aWRlb1BhdXNlIiwicGF1c2UiLCJ2aWRlb1N0b3AiLCJjdXJyZW50VGltZSIsInBsYXliYWNrUmF0ZSIsInN0eWxlIiwid2lkdGgiLCJjbGVhclRpbWVvdXQiLCJzcGVlZFUiLCJzcGVlZEQiLCJ0aW1lSW5TZWNvbmQiLCJldmVuIiwiaG91ciIsIk1hdGgiLCJmbG9vciIsIm1pbnV0ZXMiLCJzZWNvbmRzIiwiY2xpY2siLCJ2aWRlb1ZvbHVtZSIsImxldmVsIiwidW5kZWZpbmVkIiwidmFsdWUiLCJ2b2x1bWUiLCJkdXJhdGlvbiIsImlubmVySFRNTCIsInNldFRpbWVvdXQiLCJwbGF5TCIsInciLCJvZmZzZXRXaWR0aCIsIm9mZnNldFgiLCJrZXlDb2RlIiwicHJldmVudERlZmF1bHQiLCJsZWZ0IiwiY2xpZW50WCIsImlubmVyV2lkdGgiLCJjaXJjbGUiLCJsb2FkUGVyY2VudCIsImxvYWRQcm9ncmVzcyIsInJhZGl1cyIsInIiLCJiYXNlVmFsIiwiY2lyY2xlQyIsInJvdW5kIiwiUEkiLCJzdHJva2VEYXNoYXJyYXkiLCJzdHJva2VEYXNob2Zmc2V0Iiwid2luZG93U2Nyb2xsIiwid2luZG93SGVpZ2h0IiwiZG9jdW1lbnRFbGVtZW50Iiwic2Nyb2xsSGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwicGVyY2VudCIsImRpc3BsYXkiLCJjaXJjbGVMb2FkIiwicGFydCJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBQUEsUUFBQSxDQUFBO0FBQ0FDLEVBQUFBLFdBQUEsQ0FBQUMsTUFBQSxFQUFBO0FBQ0EsU0FBQUMsR0FBQSxHQUFBQyxRQUFBLENBQUFDLGFBQUEsQ0FBQUgsTUFBQSxDQUFBSSxFQUFBLENBQUE7QUFDQSxTQUFBQyxJQUFBLEdBQUEsS0FBQUosR0FBQSxDQUFBSyxxQkFBQSxFQUFBO0FBQ0EsU0FBQUMsR0FBQSxHQUFBLEtBQUFGLElBQUEsQ0FBQUUsR0FBQTtBQUVBQyxJQUFBQSxNQUFBLENBQUFDLGdCQUFBLENBQUEsUUFBQSxFQUFBLE1BQUE7QUFDQSxVQUFBQyxXQUFBLEdBQUEsQ0FBQSxFQUFBO0FBQ0EsYUFBQVQsR0FBQSxDQUFBVSxTQUFBLENBQUFDLEdBQUEsQ0FBQSxPQUFBO0FBQ0EsT0FGQSxNQUVBO0FBQ0EsYUFBQVgsR0FBQSxDQUFBVSxTQUFBLENBQUFFLE1BQUEsQ0FBQSxPQUFBO0FBQ0E7QUFDQSxLQU5BO0FBT0E7O0FBYkE7O0FBZ0JBLE1BQUFDLElBQUEsR0FBQSxJQUFBaEIsUUFBQSxDQUFBO0FBQ0FNLEVBQUFBLEVBQUEsRUFBQTtBQURBLENBQUEsQ0FBQTs7QUFLQSxNQUFBVyxPQUFBLENBQUE7QUFD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QTtBQUVBSixZQUFBLENBQUE1RSxnQkFBQSxDQUFBLE9BQUEsRUFBQSxNQUFBLENBRUEsQ0FGQTtBQUlBUCxRQUFBLENBQUFPLGdCQUFBLENBQUEsUUFBQSxFQUFBLE1BQUE7QUFDQSxNQUFBcUYsWUFBQSxHQUFBcEYsV0FBQTtBQUFBLE1BQ0FxRixZQUFBLEdBQUE3RixRQUFBLENBQUE4RixlQUFBLENBQUFDLFlBQUEsR0FBQS9GLFFBQUEsQ0FBQThGLGVBQUEsQ0FBQUUsWUFEQTtBQUFBLE1BRUFDLE9BQUEsR0FBQXRDLElBQUEsQ0FBQTZCLEtBQUEsQ0FBQUksWUFBQSxHQUFBQyxZQUFBLEdBQUEsR0FBQSxDQUZBOztBQUdBLE1BQUFyRixXQUFBLElBQUEsQ0FBQSxFQUFBO0FBQ0EyRSxJQUFBQSxZQUFBLENBQUFoQyxLQUFBLENBQUErQyxPQUFBLEdBQUEsTUFBQTtBQUNBLEdBRkEsTUFFQWYsWUFBQSxDQUFBaEMsS0FBQSxDQUFBK0MsT0FBQSxHQUFBLE1BQUE7O0FBQ0FoQixFQUFBQSxXQUFBLENBQUFaLFNBQUEsR0FBQTJCLE9BQUEsSUFBQSxDQUFBLEdBQUEsRUFBQSxHQUFBLEdBQUFBLE9BQUEsR0FBQTtBQUNBRSxFQUFBQSxVQUFBLENBQUFGLE9BQUEsQ0FBQTtBQUNBLENBVEE7O0FBV0EsU0FBQUUsVUFBQSxDQUFBRixPQUFBLEVBQUE7QUFDQSxNQUFBRyxJQUFBLEdBQUFiLE9BQUEsR0FBQVUsT0FBQSxHQUFBLEdBQUEsR0FBQVYsT0FBQTtBQUNBTixFQUFBQSxNQUFBLENBQUE5QixLQUFBLENBQUF3QyxnQkFBQSxHQUFBUyxJQUFBO0FBQ0EiLCJmaWxlIjoiY29tbW9uLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIE5hdlN0aWNrIHtcclxuICAgIGNvbnN0cnVjdG9yKHNlbGVjdCkge1xyXG4gICAgICAgIHRoaXMubmF2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3QuZWwpO1xyXG4gICAgICAgIHRoaXMucmVjdCA9IHRoaXMubmF2LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIHRoaXMudG9wID0gdGhpcy5yZWN0LnRvcDtcclxuICAgICAgICBcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgKCk9PiB7IFxyXG4gICAgICAgICAgICBpZihwYWdlWU9mZnNldCA+IDAgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5hdi5jbGFzc0xpc3QuYWRkKCdmaXhlZCcpIFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5uYXYuY2xhc3NMaXN0LnJlbW92ZSgnZml4ZWQnKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkgICBcclxuICAgIH1cclxufVxyXG5cclxuY29uc3QgbmF2bCA9IG5ldyBOYXZTdGljayAoe1xyXG4gICAgZWw6ICcuaGVhZGVyX19uYXYnXHJcbn0pXHJcbiBcclxuICIsImNsYXNzIE5hdlN0aWNrIHtcclxuICAgIGNvbnN0cnVjdG9yKHNlbGVjdCkge1xyXG4gICAgICAgIHRoaXMubmF2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3QuZWwpO1xyXG4gICAgICAgIHRoaXMucmVjdCA9IHRoaXMubmF2LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIHRoaXMudG9wID0gdGhpcy5yZWN0LnRvcDtcclxuICAgICAgICBcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgKCk9PiB7IFxyXG4gICAgICAgICAgICBpZihwYWdlWU9mZnNldCA+IDAgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5hdi5jbGFzc0xpc3QuYWRkKCdmaXhlZCcpIFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5uYXYuY2xhc3NMaXN0LnJlbW92ZSgnZml4ZWQnKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkgICBcclxuICAgIH1cclxufVxyXG5cclxuY29uc3QgbmF2bCA9IG5ldyBOYXZTdGljayAoe1xyXG4gICAgZWw6ICcuaGVhZGVyX19uYXYnXHJcbn0pXHJcbiBcclxuIFxyXG5jbGFzcyBTaWRlQmFyICB7XHJcbiAgICBjb25zdHJ1Y3RvcihvcHRpb24pIHtcclxuICAgICAgICB0aGlzLm5hdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iob3B0aW9uLmVsKTtcclxuICAgICAgICB0aGlzLm1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG9wdGlvbi5tZW51KTtcclxuICAgICAgICB0aGlzLmJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XHJcbiAgICAgICAgdGhpcy5uYXYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHtcclxuICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOyBcclxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIChlKT0+IHtcclxuICAgICAgICAgICAgICAgIGlmKGUudGFyZ2V0ICE9IHRoaXMubWVudSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVudS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LCB0cnVlKSAgXHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpPT4geyBcclxuICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn1cclxuXHJcbmNvbnN0IG5hdmJhciA9IG5ldyBTaWRlQmFyICh7XHJcbiAgICBlbDogJy5idXJnZXJfX21lbnUnLFxyXG4gICAgbWVudTogJy5oZWFkZXJfX25hdi1zaWRlJ1xyXG59KVxyXG4gXHJcbmNvbnN0ICAgcGFuZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19wYW5lbCcpLCBcclxuICAgICAgICB2aWRlbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mZWF0dXJlc19fdmlkZW8nKSxcclxuICAgICAgICBwbGF5QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZlYXR1cmVzX19wbGF5ZXItYnRuJyksXHJcbiAgICAgICAgcGxheVRpbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX190aW1lLW5vdycpLFxyXG4gICAgICAgIGZ1bGxUaW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fdGltZS1mdWxsJyksXHJcbiAgICAgICAgcHJvZ3Jlc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19wcm9ncmVzcycpLFxyXG4gICAgICAgIHByb2dyZXNzTGluZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3Byb2dyZXNzLWxpbmUnKSxcclxuICAgICAgICBwcm9ncmVzc0hvdmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fcHJvZ3Jlc3MtaG92ZXInKSxcclxuICAgICAgICBwbGF5QiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3BsYXlPclBhdXNlLXBsYXknKSxcclxuICAgICAgICBwYXVzZUIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19wbGF5T3JQYXVzZS1wYXVzZScpLFxyXG4gICAgICAgIHN0b3BCID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fc3RvcCcpLFxyXG4gICAgICAgIHNwZWVkRG93biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3NwZWVkLWRvd24nKSxcclxuICAgICAgICBzcGVlZFVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fc3BlZWQtdXAnKSxcclxuICAgICAgICB2b2x1bWVPbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3ZvbHVtZS1vbicpLFxyXG4gICAgICAgIHZvbHVtZU9mZiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3ZvbHVtZS1vZmYnKSxcclxuICAgICAgICB2b2x1bWVMZXZlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3ZvbHVtZS1sZXZlbCcpLFxyXG4gICAgICAgIGRvd25sb2FkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fZG93bmxvYWQnKTsgXHJcbiAgICAgICAgXHJcbmxldCBzcGVlZCA9IDEsICAgXHJcbiAgICBwbGF5VCxcclxuICAgIGNsaWNrRGlzcGxheSA9IDAsIFxyXG4gICAgdmlkZW9TcmMgPSB2aWRlby5nZXRBdHRyaWJ1dGUoJ3NyYycpOyAgICBcclxuZG93bmxvYWQuc2V0QXR0cmlidXRlKCdocmVmJywgdmlkZW9TcmMpOyBcclxuZnVuY3Rpb24gdmlkZW9QbGF5KCkgeyAgIFxyXG4gICAgdmlkZW8ucGxheSgpO1xyXG4gICAgcGxheUIuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7ICBcclxuICAgIHBhdXNlQi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsgIFxyXG4gICAgYXV0b3BsYXlMKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZpZGVvUGF1c2UoKSB7XHJcbiAgICB2aWRlby5wYXVzZSgpO1xyXG4gICAgcGF1c2VCLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgcGxheUIuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7IFxyXG59XHJcblxyXG5mdW5jdGlvbiB2aWRlb1N0b3AoKSB7IFxyXG4gICAgdmlkZW8ucGF1c2UoKTtcclxuICAgIHZpZGVvLmN1cnJlbnRUaW1lID0gMDtcclxuICAgIHNwZWVkID0gMTsgICBcclxuICAgIHZpZGVvLnBsYXliYWNrUmF0ZSA9IHNwZWVkO1xyXG4gICAgcGF1c2VCLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgcGxheUIuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICBwcm9ncmVzc0xpbmUuc3R5bGUud2lkdGggPSBcIjBcIjtcclxuICAgIGNsZWFyVGltZW91dChwbGF5VCk7IFxyXG59XHJcblxyXG5mdW5jdGlvbiBzcGVlZFUoKSB7XHJcbiAgICBzcGVlZCAqPSAyO1xyXG4gICAgaWYoc3BlZWQgPiA1KSB7XHJcbiAgICAgICAgc3BlZWQgPSA0O1xyXG4gICAgfVxyXG4gICAgdmlkZW8ucGxheWJhY2tSYXRlID0gc3BlZWQ7ICAgIFxyXG59XHJcbmZ1bmN0aW9uIHNwZWVkRCgpIHtcclxuICAgIHNwZWVkIC89IDI7XHJcbiAgICBpZihzcGVlZCA8IDAuMikge1xyXG4gICAgICAgIHNwZWVkID0gMC4yNTtcclxuICAgIH1cclxuICAgIHZpZGVvLnBsYXliYWNrUmF0ZSA9IHNwZWVkOyAgIFxyXG59ICBcclxuZnVuY3Rpb24gdGltZUluU2Vjb25kKGV2ZW4pIHtcclxuICAgIGxldCBob3VyID0gTWF0aC5mbG9vcihldmVuLzM2MCkgPCAxMCA/IGAwJHtNYXRoLmZsb29yKGV2ZW4vMzYwKX1gIDogTWF0aC5mbG9vcihldmVuLzM2MCksXHJcbiAgICAgICAgbWludXRlcyA9ICBNYXRoLmZsb29yKGV2ZW4vNjApIDwgMTAgPyBgMCR7TWF0aC5mbG9vcihldmVuLzYwKX1gIDogTWF0aC5mbG9vcihldmVuLzYwKSxcclxuICAgICAgICBzZWNvbmRzID0gTWF0aC5mbG9vcihldmVuJTYwKSA8IDEwID8gYDAke01hdGguZmxvb3IoZXZlbiU2MCl9YCA6IE1hdGguZmxvb3IoZXZlbiU2MCk7XHJcbiAgICBpZihob3VyID09IDApIHtcclxuICAgICAgICByZXR1cm4gYCAke21pbnV0ZXN9IDogJHtzZWNvbmRzfSBgO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gYCR7aG91cn0gOiAke21pbnV0ZXN9IDogJHtzZWNvbmRzfSBgO1xyXG4gICAgfSBcclxufVxyXG5mdW5jdGlvbiBjbGljaygpIHtcclxuICAgIGlmKGNsaWNrRGlzcGxheSA9PSAwKSB7XHJcbiAgICAgICAgY2xpY2tEaXNwbGF5ID0gMVxyXG4gICAgfWVsc2UgY2xpY2tEaXNwbGF5ID0gMFxyXG59XHJcbiBcclxuZnVuY3Rpb24gdmlkZW9Wb2x1bWUobGV2ZWwpIHsgXHJcbiAgICBsZXZlbCA9IGxldmVsID09IHVuZGVmaW5lZCA/IHZvbHVtZUxldmVsLnZhbHVlIDogbGV2ZWw7XHJcbiAgICB2aWRlby52b2x1bWUgPSBsZXZlbCAvIDEwMDsgICAgXHJcbn0gXHJcbmZ1bmN0aW9uIGF1dG9wbGF5TCgpIHsgIFxyXG4gICAgcHJvZ3Jlc3NMaW5lLnN0eWxlLndpZHRoID0gYCR7KHZpZGVvLmN1cnJlbnRUaW1lKjEwMCkvdmlkZW8uZHVyYXRpb259JWA7IFxyXG4gICAgcGxheVRpbWUuaW5uZXJIVE1MID0gYCR7dGltZUluU2Vjb25kKE1hdGguZmxvb3IodmlkZW8uY3VycmVudFRpbWUpKX1gOyAgXHJcbiAgICBcclxuICAgIGlmKHZpZGVvLmN1cnJlbnRUaW1lID09IHZpZGVvLmR1cmF0aW9uKSB7XHJcbiAgICAgICAgdmlkZW9TdG9wKCkgXHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHBsYXlUKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBwbGF5VCA9IHNldFRpbWVvdXQgKGF1dG9wbGF5TCwgMTAwMCk7ICBcclxuICAgIFxyXG59XHJcbmZ1bmN0aW9uIHBsYXlMKGV2ZW4pIHtcclxuICAgIGxldCB3ID0gcHJvZ3Jlc3Mub2Zmc2V0V2lkdGgsXHJcbiAgICAgICAgZSA9IGV2ZW4ub2Zmc2V0WDsgIFxyXG4gICAgcHJvZ3Jlc3NMaW5lLnN0eWxlLndpZHRoID0gYCR7KGUqMTAwKS93fSVgO1xyXG4gICAgdmlkZW8uY3VycmVudFRpbWUgPSB2aWRlby5kdXJhdGlvbiAqIChlL3cpO1xyXG59XHJcbnBsYXlCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpPT4ge1xyXG4gICAgZnVsbFRpbWUuaW5uZXJIVE1MID0gdGltZUluU2Vjb25kKCBNYXRoLmZsb29yKHZpZGVvLmR1cmF0aW9uKSk7IFxyXG4gICAgcGxheUJ0bi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsgXHJcbiAgICBzZXRUaW1lb3V0KCgpPT4ge3BhbmVsLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpfSwgNTAwKTsgIFxyXG4gICAgc2V0VGltZW91dCh2aWRlb1BsYXksIDUwMCk7ICBcclxuICAgIHZpZGVvVm9sdW1lKCk7XHJcbiAgICBhdXRvcGxheUwoKTsgXHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSk9PiB7ICBcclxuICAgICAgICBpZihlLmtleUNvZGUgPT0gMzIpe1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGlmKGNsaWNrRGlzcGxheSA9PSAwKSB7XHJcbiAgICAgICAgICAgIHZpZGVvUGF1c2UoKTtcclxuICAgICAgICAgICAgY2xpY2soKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2aWRlb1BsYXkoKTtcclxuICAgICAgICAgICAgY2xpY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAgICAgXHJcbiAgIH0pXHJcbn0pIFxyXG52aWRlby5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4ge1xyXG4gICAgaWYoY2xpY2tEaXNwbGF5ID09IDApe1xyXG4gICAgICAgIGNsaWNrKCk7XHJcbiAgICAgICAgdmlkZW9QYXVzZSgpO1xyXG4gICAgfSBlbHNlIGlmIChjbGlja0Rpc3BsYXkgPT0gMSl7XHJcbiAgICAgICAgY2xpY2soKTtcclxuICAgICAgICB2aWRlb1BsYXkoKTtcclxuICAgIH1cclxufSlcclxuXHJcbnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgKGUpPT4ge1xyXG4gICAgbGV0IHJlY3QgPSB2aWRlby5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcclxuICAgICAgICBsZWZ0ID0gcmVjdC5sZWZ0O1xyXG4gICAgaWYoZS5jbGllbnRYID4gbGVmdCAmJiBlLmNsaWVudFggPCBpbm5lcldpZHRoLzIpIHtcclxuICAgICAgICB2aWRlby5jdXJyZW50VGltZSAtPSAxMFxyXG4gICAgfSBlbHNlIGlmIChlLmNsaWVudFggPCBpbm5lcldpZHRoIC0gbGVmdCAmJiBlLmNsaWVudFggPiBpbm5lcldpZHRoLzIpe1xyXG4gICAgICAgIHZpZGVvLmN1cnJlbnRUaW1lICs9IDEwXHJcbiAgICB9XHJcbiAgICBcclxufSlcclxuIFxyXG5wYXVzZUIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHtcclxuICAgIHZpZGVvUGF1c2UoKTsgXHJcbiAgICBjbGVhclRpbWVvdXQocGxheVQpO1xyXG4gICAgY2xpY2soKTtcclxufSlcclxuXHJcbnBsYXlCLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7XHJcbiAgICB2aWRlb1BsYXkoKTtcclxuICAgIGF1dG9wbGF5TCgpO1xyXG4gICAgY2xpY2soKTtcclxufSlcclxuXHJcbnN0b3BCLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7XHJcbiAgICB2aWRlb1N0b3AoKTsgXHJcbn0pXHJcblxyXG5zcGVlZERvd24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHsgIFxyXG4gICAgc3BlZWREKCk7XHJcbn0pXHJcbnNwZWVkVXAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHsgIFxyXG4gICAgc3BlZWRVKCk7XHJcbn0pXHJcblxyXG52b2x1bWVMZXZlbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKT0+IHsgIFxyXG4gICAgdmlkZW9Wb2x1bWUodm9sdW1lTGV2ZWwudmFsdWUpO1xyXG4gICAgaWYodm9sdW1lTGV2ZWwudmFsdWUgPT0gMCApIHtcclxuICAgICAgICB2b2x1bWVPbi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICB2b2x1bWVPZmYuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHZvbHVtZU9mZi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICB2b2x1bWVPbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgIH1cclxufSlcclxuXHJcbnZvbHVtZU9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7XHJcbiAgICB2aWRlb1ZvbHVtZSgwKTsgXHJcbiAgICB2b2x1bWVPbi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgIHZvbHVtZU9mZi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxufSlcclxuXHJcbnZvbHVtZU9mZi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4ge1xyXG4gICAgdmlkZW9Wb2x1bWUodm9sdW1lTGV2ZWwudmFsdWUpOyBcclxuICAgIHZvbHVtZU9mZi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgIHZvbHVtZU9uLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG59KVxyXG5cclxucHJvZ3Jlc3MuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSk9PiB7XHJcbiAgICBpZihjbGlja0Rpc3BsYXkgPT0gMCl7XHJcbiAgICAgICAgdmlkZW9QYXVzZSgpO1xyXG4gICAgICAgIHBsYXlMKGUpO1xyXG4gICAgICAgIHZpZGVvUGxheSgpOyBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcGxheUwoZSk7IFxyXG4gICAgfVxyXG4gICBcclxufSlcclxuXHJcbnByb2dyZXNzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIChlKT0+IHsgIFxyXG4gICAgcHJvZ3Jlc3NIb3Zlci5zdHlsZS53aWR0aCA9IGAkeyhlLm9mZnNldFgqMTAwKS9wcm9ncmVzcy5vZmZzZXRXaWR0aH0lYDtcclxufSlcclxucHJvZ3Jlc3MuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIChlKT0+IHsgIFxyXG4gICAgcHJvZ3Jlc3NIb3Zlci5zdHlsZS53aWR0aCA9IGAwJWA7XHJcbn0pXHJcbiBcclxuIFxyXG5jb25zdCAgIGNpcmNsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9ncmVzc19fcmluZy1jaXJjbGUnKSxcclxuICAgICAgICBsb2FkUGVyY2VudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9ncmVzc19fbG9hZC1wZXJjZW50JyksIFxyXG4gICAgICAgIGxvYWRQcm9ncmVzcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9ncmVzc19fbG9hZCcpLCBcclxuICAgICAgICBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLFxyXG4gICAgICAgIG5hdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX25hdicpLFxyXG4gICAgICAgIHJhZGl1cyA9IGNpcmNsZS5yLmJhc2VWYWwudmFsdWUsXHJcbiAgICAgICAgY2lyY2xlQyA9IE1hdGgucm91bmQoMiAqIE1hdGguUEkgKiByYWRpdXMpOyBcclxuY2lyY2xlLnN0eWxlLnN0cm9rZURhc2hhcnJheSA9IGAke2NpcmNsZUN9ICR7Y2lyY2xlQ31gOyBcclxuY2lyY2xlLnN0eWxlLnN0cm9rZURhc2hvZmZzZXQgPSBjaXJjbGVDIDsgXHJcblxyXG5sb2FkUHJvZ3Jlc3MuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHsgXHJcbiAgICBcclxufSlcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcgLCAoKT0+IHsgICBcclxuICAgIGxldCB3aW5kb3dTY3JvbGwgPSBwYWdlWU9mZnNldCxcclxuICAgICAgICB3aW5kb3dIZWlnaHQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsSGVpZ2h0IC0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCxcclxuICAgICAgICBwZXJjZW50ID0gTWF0aC5yb3VuZCh3aW5kb3dTY3JvbGwgLyB3aW5kb3dIZWlnaHQgKiAxMDApO1xyXG4gICAgaWYocGFnZVlPZmZzZXQgPT0gMCApe1xyXG4gICAgICAgIGxvYWRQcm9ncmVzcy5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCIgXHJcbiAgICB9IGVsc2UgIGxvYWRQcm9ncmVzcy5zdHlsZS5kaXNwbGF5ID0gXCJmbGV4XCIgXHJcbiAgICBsb2FkUGVyY2VudC5pbm5lckhUTUwgPSAgcGVyY2VudCAgPT0gMCA/IFwiXCIgOiBgJHsgcGVyY2VudH0lYDtcclxuICAgIGNpcmNsZUxvYWQocGVyY2VudCk7XHJcbn0pXHJcbiAgICBcclxuIGZ1bmN0aW9uIGNpcmNsZUxvYWQocGVyY2VudCkge1xyXG4gICAgIGxldCBwYXJ0ID0gY2lyY2xlQyAtIHBlcmNlbnQgLyAxMDAgKiBjaXJjbGVDO1xyXG4gICAgIGNpcmNsZS5zdHlsZS5zdHJva2VEYXNob2Zmc2V0ID0gcGFydCA7XHJcbiAgIH1cclxuIFxyXG5cclxuXHJcblxyXG4gXHJcbiIsImNsYXNzIFNpZGVCYXIgIHtcclxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbikge1xyXG4gICAgICAgIHRoaXMubmF2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihvcHRpb24uZWwpO1xyXG4gICAgICAgIHRoaXMubWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iob3B0aW9uLm1lbnUpO1xyXG4gICAgICAgIHRoaXMuYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcclxuICAgICAgICB0aGlzLm5hdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4ge1xyXG4gICAgICAgICAgICB0aGlzLm1lbnUuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7IFxyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKGUpPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYoZS50YXJnZXQgIT0gdGhpcy5tZW51KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW51LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0sIHRydWUpICBcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCk9PiB7IFxyXG4gICAgICAgICAgICB0aGlzLm1lbnUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG5cclxuY29uc3QgbmF2YmFyID0gbmV3IFNpZGVCYXIgKHtcclxuICAgIGVsOiAnLmJ1cmdlcl9fbWVudScsXHJcbiAgICBtZW51OiAnLmhlYWRlcl9fbmF2LXNpZGUnXHJcbn0pXHJcbiAiLCJjb25zdCAgIHBhbmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fcGFuZWwnKSwgXHJcbiAgICAgICAgdmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmVhdHVyZXNfX3ZpZGVvJyksXHJcbiAgICAgICAgcGxheUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mZWF0dXJlc19fcGxheWVyLWJ0bicpLFxyXG4gICAgICAgIHBsYXlUaW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fdGltZS1ub3cnKSxcclxuICAgICAgICBmdWxsVGltZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3RpbWUtZnVsbCcpLFxyXG4gICAgICAgIHByb2dyZXNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fcHJvZ3Jlc3MnKSxcclxuICAgICAgICBwcm9ncmVzc0xpbmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19wcm9ncmVzcy1saW5lJyksXHJcbiAgICAgICAgcHJvZ3Jlc3NIb3ZlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3Byb2dyZXNzLWhvdmVyJyksXHJcbiAgICAgICAgcGxheUIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19wbGF5T3JQYXVzZS1wbGF5JyksXHJcbiAgICAgICAgcGF1c2VCID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllcl9fcGxheU9yUGF1c2UtcGF1c2UnKSxcclxuICAgICAgICBzdG9wQiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3N0b3AnKSxcclxuICAgICAgICBzcGVlZERvd24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX19zcGVlZC1kb3duJyksXHJcbiAgICAgICAgc3BlZWRVcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX3NwZWVkLXVwJyksXHJcbiAgICAgICAgdm9sdW1lT24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX192b2x1bWUtb24nKSxcclxuICAgICAgICB2b2x1bWVPZmYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX192b2x1bWUtb2ZmJyksXHJcbiAgICAgICAgdm9sdW1lTGV2ZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyX192b2x1bWUtbGV2ZWwnKSxcclxuICAgICAgICBkb3dubG9hZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXJfX2Rvd25sb2FkJyk7IFxyXG4gICAgICAgIFxyXG5sZXQgc3BlZWQgPSAxLCAgIFxyXG4gICAgcGxheVQsXHJcbiAgICBjbGlja0Rpc3BsYXkgPSAwLCBcclxuICAgIHZpZGVvU3JjID0gdmlkZW8uZ2V0QXR0cmlidXRlKCdzcmMnKTsgICAgXHJcbmRvd25sb2FkLnNldEF0dHJpYnV0ZSgnaHJlZicsIHZpZGVvU3JjKTsgXHJcbmZ1bmN0aW9uIHZpZGVvUGxheSgpIHsgICBcclxuICAgIHZpZGVvLnBsYXkoKTtcclxuICAgIHBsYXlCLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOyAgXHJcbiAgICBwYXVzZUIuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7ICBcclxuICAgIGF1dG9wbGF5TCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB2aWRlb1BhdXNlKCkge1xyXG4gICAgdmlkZW8ucGF1c2UoKTtcclxuICAgIHBhdXNlQi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgIHBsYXlCLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOyBcclxufVxyXG5cclxuZnVuY3Rpb24gdmlkZW9TdG9wKCkgeyBcclxuICAgIHZpZGVvLnBhdXNlKCk7XHJcbiAgICB2aWRlby5jdXJyZW50VGltZSA9IDA7XHJcbiAgICBzcGVlZCA9IDE7ICAgXHJcbiAgICB2aWRlby5wbGF5YmFja1JhdGUgPSBzcGVlZDtcclxuICAgIHBhdXNlQi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgIHBsYXlCLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgcHJvZ3Jlc3NMaW5lLnN0eWxlLndpZHRoID0gXCIwXCI7XHJcbiAgICBjbGVhclRpbWVvdXQocGxheVQpOyBcclxufVxyXG5cclxuZnVuY3Rpb24gc3BlZWRVKCkge1xyXG4gICAgc3BlZWQgKj0gMjtcclxuICAgIGlmKHNwZWVkID4gNSkge1xyXG4gICAgICAgIHNwZWVkID0gNDtcclxuICAgIH1cclxuICAgIHZpZGVvLnBsYXliYWNrUmF0ZSA9IHNwZWVkOyAgICBcclxufVxyXG5mdW5jdGlvbiBzcGVlZEQoKSB7XHJcbiAgICBzcGVlZCAvPSAyO1xyXG4gICAgaWYoc3BlZWQgPCAwLjIpIHtcclxuICAgICAgICBzcGVlZCA9IDAuMjU7XHJcbiAgICB9XHJcbiAgICB2aWRlby5wbGF5YmFja1JhdGUgPSBzcGVlZDsgICBcclxufSAgXHJcbmZ1bmN0aW9uIHRpbWVJblNlY29uZChldmVuKSB7XHJcbiAgICBsZXQgaG91ciA9IE1hdGguZmxvb3IoZXZlbi8zNjApIDwgMTAgPyBgMCR7TWF0aC5mbG9vcihldmVuLzM2MCl9YCA6IE1hdGguZmxvb3IoZXZlbi8zNjApLFxyXG4gICAgICAgIG1pbnV0ZXMgPSAgTWF0aC5mbG9vcihldmVuLzYwKSA8IDEwID8gYDAke01hdGguZmxvb3IoZXZlbi82MCl9YCA6IE1hdGguZmxvb3IoZXZlbi82MCksXHJcbiAgICAgICAgc2Vjb25kcyA9IE1hdGguZmxvb3IoZXZlbiU2MCkgPCAxMCA/IGAwJHtNYXRoLmZsb29yKGV2ZW4lNjApfWAgOiBNYXRoLmZsb29yKGV2ZW4lNjApO1xyXG4gICAgaWYoaG91ciA9PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIGAgJHttaW51dGVzfSA6ICR7c2Vjb25kc30gYDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGAke2hvdXJ9IDogJHttaW51dGVzfSA6ICR7c2Vjb25kc30gYDtcclxuICAgIH0gXHJcbn1cclxuZnVuY3Rpb24gY2xpY2soKSB7XHJcbiAgICBpZihjbGlja0Rpc3BsYXkgPT0gMCkge1xyXG4gICAgICAgIGNsaWNrRGlzcGxheSA9IDFcclxuICAgIH1lbHNlIGNsaWNrRGlzcGxheSA9IDBcclxufVxyXG4gXHJcbmZ1bmN0aW9uIHZpZGVvVm9sdW1lKGxldmVsKSB7IFxyXG4gICAgbGV2ZWwgPSBsZXZlbCA9PSB1bmRlZmluZWQgPyB2b2x1bWVMZXZlbC52YWx1ZSA6IGxldmVsO1xyXG4gICAgdmlkZW8udm9sdW1lID0gbGV2ZWwgLyAxMDA7ICAgIFxyXG59IFxyXG5mdW5jdGlvbiBhdXRvcGxheUwoKSB7ICBcclxuICAgIHByb2dyZXNzTGluZS5zdHlsZS53aWR0aCA9IGAkeyh2aWRlby5jdXJyZW50VGltZSoxMDApL3ZpZGVvLmR1cmF0aW9ufSVgOyBcclxuICAgIHBsYXlUaW1lLmlubmVySFRNTCA9IGAke3RpbWVJblNlY29uZChNYXRoLmZsb29yKHZpZGVvLmN1cnJlbnRUaW1lKSl9YDsgIFxyXG4gICAgXHJcbiAgICBpZih2aWRlby5jdXJyZW50VGltZSA9PSB2aWRlby5kdXJhdGlvbikge1xyXG4gICAgICAgIHZpZGVvU3RvcCgpIFxyXG4gICAgICAgIGNsZWFyVGltZW91dChwbGF5VCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcGxheVQgPSBzZXRUaW1lb3V0IChhdXRvcGxheUwsIDEwMDApOyAgXHJcbiAgICBcclxufVxyXG5mdW5jdGlvbiBwbGF5TChldmVuKSB7XHJcbiAgICBsZXQgdyA9IHByb2dyZXNzLm9mZnNldFdpZHRoLFxyXG4gICAgICAgIGUgPSBldmVuLm9mZnNldFg7ICBcclxuICAgIHByb2dyZXNzTGluZS5zdHlsZS53aWR0aCA9IGAkeyhlKjEwMCkvd30lYDtcclxuICAgIHZpZGVvLmN1cnJlbnRUaW1lID0gdmlkZW8uZHVyYXRpb24gKiAoZS93KTtcclxufVxyXG5wbGF5QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKT0+IHtcclxuICAgIGZ1bGxUaW1lLmlubmVySFRNTCA9IHRpbWVJblNlY29uZCggTWF0aC5mbG9vcih2aWRlby5kdXJhdGlvbikpOyBcclxuICAgIHBsYXlCdG4uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7IFxyXG4gICAgc2V0VGltZW91dCgoKT0+IHtwYW5lbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKX0sIDUwMCk7ICBcclxuICAgIHNldFRpbWVvdXQodmlkZW9QbGF5LCA1MDApOyAgXHJcbiAgICB2aWRlb1ZvbHVtZSgpO1xyXG4gICAgYXV0b3BsYXlMKCk7IFxyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpPT4geyAgXHJcbiAgICAgICAgaWYoZS5rZXlDb2RlID09IDMyKXtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBpZihjbGlja0Rpc3BsYXkgPT0gMCkge1xyXG4gICAgICAgICAgICB2aWRlb1BhdXNlKCk7XHJcbiAgICAgICAgICAgIGNsaWNrKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmlkZW9QbGF5KCk7XHJcbiAgICAgICAgICAgIGNsaWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgICAgIFxyXG4gICB9KVxyXG59KSBcclxudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHtcclxuICAgIGlmKGNsaWNrRGlzcGxheSA9PSAwKXtcclxuICAgICAgICBjbGljaygpO1xyXG4gICAgICAgIHZpZGVvUGF1c2UoKTtcclxuICAgIH0gZWxzZSBpZiAoY2xpY2tEaXNwbGF5ID09IDEpe1xyXG4gICAgICAgIGNsaWNrKCk7XHJcbiAgICAgICAgdmlkZW9QbGF5KCk7XHJcbiAgICB9XHJcbn0pXHJcblxyXG52aWRlby5hZGRFdmVudExpc3RlbmVyKCdkYmxjbGljaycsIChlKT0+IHtcclxuICAgIGxldCByZWN0ID0gdmlkZW8uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXHJcbiAgICAgICAgbGVmdCA9IHJlY3QubGVmdDtcclxuICAgIGlmKGUuY2xpZW50WCA+IGxlZnQgJiYgZS5jbGllbnRYIDwgaW5uZXJXaWR0aC8yKSB7XHJcbiAgICAgICAgdmlkZW8uY3VycmVudFRpbWUgLT0gMTBcclxuICAgIH0gZWxzZSBpZiAoZS5jbGllbnRYIDwgaW5uZXJXaWR0aCAtIGxlZnQgJiYgZS5jbGllbnRYID4gaW5uZXJXaWR0aC8yKXtcclxuICAgICAgICB2aWRlby5jdXJyZW50VGltZSArPSAxMFxyXG4gICAgfVxyXG4gICAgXHJcbn0pXHJcbiBcclxucGF1c2VCLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7XHJcbiAgICB2aWRlb1BhdXNlKCk7IFxyXG4gICAgY2xlYXJUaW1lb3V0KHBsYXlUKTtcclxuICAgIGNsaWNrKCk7XHJcbn0pXHJcblxyXG5wbGF5Qi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4ge1xyXG4gICAgdmlkZW9QbGF5KCk7XHJcbiAgICBhdXRvcGxheUwoKTtcclxuICAgIGNsaWNrKCk7XHJcbn0pXHJcblxyXG5zdG9wQi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4ge1xyXG4gICAgdmlkZW9TdG9wKCk7IFxyXG59KVxyXG5cclxuc3BlZWREb3duLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7ICBcclxuICAgIHNwZWVkRCgpO1xyXG59KVxyXG5zcGVlZFVwLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiB7ICBcclxuICAgIHNwZWVkVSgpO1xyXG59KVxyXG5cclxudm9sdW1lTGV2ZWwuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCk9PiB7ICBcclxuICAgIHZpZGVvVm9sdW1lKHZvbHVtZUxldmVsLnZhbHVlKTtcclxuICAgIGlmKHZvbHVtZUxldmVsLnZhbHVlID09IDAgKSB7XHJcbiAgICAgICAgdm9sdW1lT24uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICAgICAgdm9sdW1lT2ZmLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB2b2x1bWVPZmYuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICAgICAgdm9sdW1lT24uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICB9XHJcbn0pXHJcblxyXG52b2x1bWVPbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4ge1xyXG4gICAgdmlkZW9Wb2x1bWUoMCk7IFxyXG4gICAgdm9sdW1lT24uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICB2b2x1bWVPZmYuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbn0pXHJcblxyXG52b2x1bWVPZmYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IHtcclxuICAgIHZpZGVvVm9sdW1lKHZvbHVtZUxldmVsLnZhbHVlKTsgXHJcbiAgICB2b2x1bWVPZmYuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICB2b2x1bWVPbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxufSlcclxuXHJcbnByb2dyZXNzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT4ge1xyXG4gICAgaWYoY2xpY2tEaXNwbGF5ID09IDApe1xyXG4gICAgICAgIHZpZGVvUGF1c2UoKTtcclxuICAgICAgICBwbGF5TChlKTtcclxuICAgICAgICB2aWRlb1BsYXkoKTsgXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHBsYXlMKGUpOyBcclxuICAgIH1cclxuICAgXHJcbn0pXHJcblxyXG5wcm9ncmVzcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCAoZSk9PiB7ICBcclxuICAgIHByb2dyZXNzSG92ZXIuc3R5bGUud2lkdGggPSBgJHsoZS5vZmZzZXRYKjEwMCkvcHJvZ3Jlc3Mub2Zmc2V0V2lkdGh9JWA7XHJcbn0pXHJcbnByb2dyZXNzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoZSk9PiB7ICBcclxuICAgIHByb2dyZXNzSG92ZXIuc3R5bGUud2lkdGggPSBgMCVgO1xyXG59KVxyXG4gXHJcbiAiXX0=
